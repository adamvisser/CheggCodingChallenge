

function runUsernameClick() {
	//TODO the user has now clicked check so we need to make sure its not empty, else give an error
	if (!formIsEmpty()) {
		populateUseableUserNameListFromService();
		tellViewRequestIsLoading();
	} else {
		console.log(getFormValue());
		tellViewInputIsEmpty();
	}
}

function runObservers() {
	//TODO actually flesh these out to "guess" possible usernames to send over in addition to what they check that FIRST click
	runWordObserver();
	runEmptyObserver();
}

function setupApp() {

	// The User search API accepts a comma-separated list of usernames, and returns
	// user data for any matching records
	$.ajax("http://chegg-tutors.appspot.com/coding-challenge/api/user/?username=Hillary2016").done(function (data) {
		// This logs Hillary2016's user data, since the username is registered
		//console.log(JSON.stringify(data));
		//raw please thanks!!!
		console.log(data);
	});
	$.ajax("http://chegg-tutors.appspot.com/coding-challenge/api/user/?username=Trump4Pres,FeelTheBern1").done(function (data) {
		// This logs Trump4Pres's user data, since the username is registered, but
		// no user data for FeelTheBern1, since that username is not currently registered
		//console.log(JSON.stringify(data);
		//raw please thanks!!!
		console.log(data);
	});
	$("#chg-balloon-input").change(function () {
		// This is where you come in!!
		//i came in like a wrecking ball
		console.log('ran observers');
		runObservers();
	});
	$("#chg-balloon-submit").click(function () {
		// This is where you come in!!
		//i came in like a wrecking ball
		console.log('click ran');
		runUsernameClick();
	});
}


function runEmptyObserver() {
	// TODO the form is now empty so we should clear the list of useable usernames (add them to badd list?)
	// TODO we should also clear out the suggested list
	if (formIsEmpty()) {
		console.log('empty observer wouldve just now ran');
	}
}


function runWordObserver() {
	// TODO the form is being typed in so we need to set some things to check for to try and guess/assume words
	// TODO check if a user used common ways to denote a change in the word.
	//TODO after above then add the word that just ended to the list if not already there
	if (!formIsEmpty()) {
		console.log('word observer wouldve just now ran');
	}
}


function formIsEmpty() {
	// body...
	if (getFormValue() == "") {
		return true;
	}
	return false;
}

function getFormValue() {
	return $("#chg-balloon-input").val();
}


function tellViewRequestIsLoading() {
	//TODO we add in a "were loading" message for the user
}

function tellViewRequestIsDone(names) {
	var newHTML = "";
	function addToIterateArray(name) {
		newHTML = newHTML.concat("<i class='green checkmark box icon'></i>".concat(name, "</br>"));
	}
	names.forEach(addToIterateArray);
	$("#username-suggestion-view").html(newHTML);
}

function tellViewInputIsEmpty() {
	// body...
}

function tellViewNameIsAvailable() {
	var newHTML = "<i class='green checkmark box icon'></i>".concat(getFormValue());
	newHTML = newHTML.concat(", is Available! Hit next to proced (or normally where the programmer would just auto move on to the next part)");
	$("#username-availability").html(newHTML);
}

function tellViewNameIsUnAvailable() {
	var newHTML = "<i class='red checkmark box icon'></i>".concat(getFormValue());
	newHTML = newHTML.concat(", is Un-available! Please try a suggestion from below or try a new username!");
	$("#username-availability").html(newHTML);
}


function setupUserNameList() {
	//since I dont have anything to act as "scope" we will pretend like its the whole window (app)
	if (window.USERNAMELIST === undefined) {
		window.USERNAMELIST = {};
		window.USERNAMELIST.usernameList = [];
		window.USERNAMELIST.goodUserNames = [];
		window.USERNAMELIST.badUserNames = [];
	}
}

function userNameLength() {
	return window.USERNAMELIST.usernameList.length;
}

//this just returns a list of useable username objects, or a string for use within a request. depending on the former will depend on what it returns upon fail, not sure just yet lots to do
function getUserNameList(forRequest = false) {

	//I wanted to make sure that only this function can get called, so that it will return the proper stuff, encapsulation things.
	//this returns the list of GOOD usernames as an array
	function getUseableUserNameListForAnIteration() {}

	//this returns the list of usernames as a string
	function getUseableUserNameListForARequest() {
		//this is needed to actually return something
		var returnString = "";

		//lets make sure that this scope has the ability to foreach over the array we are about to create
		//without having to create the function in line
		function addUserName(item) {
			console.log(item);
			returnString = returnString.concat(item);
			returnString = returnString.concat(",");
		}
		window.USERNAMELIST.usernameList.forEach(addUserName);
		returnString = returnString.substring(0, returnString.length - 1);
		return returnString;
	}

	if (forRequest) {
		return getUseableUserNameListForARequest();
	} else {
		return getUseableUserNameListForARequest();
	}
}

//this actually sets up, then runs the ajax request
function populateUseableUserNameListFromService() {
	// TODO check the below runs correctly
	setupUserNameList();
	if (userNameLength() < 1) {
		console.log('no useable usernames pregenerated!');
		noUseableUsernamesAddNumbers();
	}
	// TODO use the json service to send a request using the usernameList from window scope
	sendRequest();
}

//this is the fucntion that ajax calls when it successfullly recieves a response
function populateUseableUserNameList(data) {
	var inputUserNameIsAvailable = true;
	function mapDataToUserNameArray(value, index) {
		return value.username;
	}
	function setupBadUserName(item) {
		if (getFormValue() == item) {
			inputUserNameIsAvailable = false;
		}
		window.USERNAMELIST.badUserNames.push(String(item));
	}

	function setupGoodUserName(item) {
		if (window.USERNAMELIST.badUserNames.indexOf(String(item)) == -1) {
			window.USERNAMELIST.goodUserNames.push(String(item));
		}
	}
	//dont forget you cant iterate blindly over an object like this is mongo adam!!!!
	data = $.map(data, mapDataToUserNameArray);
	// TODO check the below runs correctly
	setupUserNameList();
	data.forEach(setupBadUserName);
	window.USERNAMELIST.usernameList.forEach(setupGoodUserName);
	window.USERNAMELIST.usernameList = [];
	// TODO from response put list of good usernames in place
	if (inputUserNameIsAvailable) {
		tellViewNameIsAvailable();
	} else {
		tellViewNameIsUnAvailable();
	}
	tellViewRequestIsDone(window.USERNAMELIST.goodUserNames);
}

//this is used by the form observers to add in possible names as they find them
function addNameToList(name) {
	// TODO check the below runs correctly
	setupUserNameList();
	//again casing as string cuz ive put no time into error handline
	window.USERNAMELIST.usernameList.push(String(name));
}

//this is used by the ajax response function to add in names that wont work
function addNameToBadList(name) {}
// TODO add in name to the list of bad user names in window scope


//this is used by the ajax response function to add in names that will work
function addNameToGoodList(name) {
	// TODO add in name to the list of good user names in window scope
}
//TODO implement this out to actually check for words, instead of just being all "hey look i can add 2 numbers at the end"

function finalWordCheck() {
	// TODO before we send off the request, make sure we have enough user names being sent of in the request
	// TODO make sure the below gets called at the right time, and works
}

function noUseableUsernamesAddNumbers() {
	// TODO we havent done so well and have no words to use to generate some good words, just add some numbers to whats in the form :(

	//lets make sure that this scope has the ability to foreach over the array we are about to create
	//without having to create the function in line
	function addRandomUserName(item) {
		addNameToList(formWord.concat(item));
	}

	console.log('O No! observers found no words, adding numbers so we have some now');
	//first we need some numbers
	//lets make sure they dont have a way of being the same!!!!
	var randomNumber = Math.floor(Math.random() * 1000);
	var randomModifer = Math.floor(Math.random() * 100);
	var randomDivider = Math.floor(Math.random() * 10);
	var randomNumbers = [String(randomNumber), String(randomNumber + randomModifer), String(randomNumber - randomModifer), String(Math.floor((randomNumber + randomModifer) / randomDivider)), String(Math.floor((randomNumber - randomModifer) / randomDivider))];
	//then we need to get the username itself, gonna cast as string cuz... i have no error handling like anywhere in here and im scared
	var formWord = String(getFormValue());
	randomNumbers.forEach(addRandomUserName);
	//cant forget to add the one that the user already suggested since everything is empty!!!
	addNameToList(formWord);
}

//one of the observers may have found a new word to use, check for it then add it in
function addWordToUseableWordsList(word) {
	// TODO make the above comment come true
}

function getUseableWordsList() {
	// TODO
}

function setupWordsList() {
	//since I dont have anything to act as "scope" we will pretend like its the whole window (app)
	if (window.WORDOBSERVER === undefined) {
		window.WORDOBSERVER = {};
		window.WORDOBSERVER.wordlist = {};
	}
}


function sendRequest() {
	function proeccessRequestResponse(data) {
		// This logs Trump4Pres's user data, since the username is registered, but
		// no user data for FeelTheBern1, since that username is not currently registered
		console.log("request done, logic starting");
		populateUseableUserNameList(data);
		console.log("request logic done");
	}

	// TODO use the below copied code to bring all the comments below it to life
	var url = "http://chegg-tutors.appspot.com/coding-challenge/api/user/?username=".concat(getUserNameList(true));
	console.log(url);
	$.ajax(url).done(function (data) {
		// This logs Hillary2016's user data, since the username is registered
		//console.log(JSON.stringify(data));
		//raw please thanks!!!
		console.log(data);
		proeccessRequestResponse(data);
	});
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsIkVtcHR5T2JzZXJ2ZXIuanMiLCJXb3JkT2JzZXJ2ZXIuanMiLCJGb3JtLmpzIiwiU3VnZ2VzdGlvblZpZXcuanMiLCJVc2VyTmFtZUxpc3QuanMiLCJXb3JkTGlzdC5qcyIsIlVzZXJOYW1lU2VydmljZS5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUlBLFNBQVMsZ0JBQVQsR0FBMkI7O0FBRTFCLEtBQUksQ0FBQyxhQUFELEVBQWdCO0FBQ25CLDJDQURtQjtBQUVuQiw2QkFGbUI7RUFBcEIsTUFHTztBQUNOLFVBQVEsR0FBUixDQUFZLGNBQVosRUFETTtBQUVOLHlCQUZNO0VBSFA7Q0FGRDs7QUFjQSxTQUFTLFlBQVQsR0FBdUI7O0FBRXRCLG1CQUZzQjtBQUd0QixvQkFIc0I7Q0FBdkI7O0FBTUEsU0FBUyxRQUFULEdBQW1COzs7O0FBSWxCLEdBQUUsSUFBRixDQUFPLGlGQUFQLEVBQTBGLElBQTFGLENBQStGLFVBQVMsSUFBVCxFQUFlOzs7O0FBSTdHLFVBQVEsR0FBUixDQUFZLElBQVosRUFKNkc7RUFBZixDQUEvRixDQUprQjtBQVVsQixHQUFFLElBQUYsQ0FBTyw2RkFBUCxFQUFzRyxJQUF0RyxDQUEyRyxVQUFTLElBQVQsRUFBZTs7Ozs7QUFLekgsVUFBUSxHQUFSLENBQVksSUFBWixFQUx5SDtFQUFmLENBQTNHLENBVmtCO0FBaUJsQixHQUFFLG9CQUFGLEVBQXdCLE1BQXhCLENBQStCLFlBQVc7OztBQUd6QyxVQUFRLEdBQVIsQ0FBWSxlQUFaLEVBSHlDO0FBSXpDLGlCQUp5QztFQUFYLENBQS9CLENBakJrQjtBQXVCbEIsR0FBRSxxQkFBRixFQUF5QixLQUF6QixDQUErQixZQUFXOzs7QUFHekMsVUFBUSxHQUFSLENBQVksV0FBWixFQUh5QztBQUl6QyxxQkFKeUM7RUFBWCxDQUEvQixDQXZCa0I7Q0FBbkI7OztBQ2xCQSxTQUFTLGdCQUFULEdBQTRCOzs7QUFHM0IsS0FBSSxhQUFKLEVBQW1CO0FBQ2xCLFVBQVEs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QUFXLENBQUMsZUFBZSxhQUFmLENBQUQsR0FBa0MsYUFBbEMsQ0FBbEIsQ0FMbUIsQ0FBaEI7O0FBaEJrQyxLQXdCbEMsV0FBVyxPQUFPLGNBQVAsQ0FBWCxDQXhCa0M7QUF5QnRDLGVBQWMsT0FBZCxDQUFzQixpQkFBdEI7O0FBekJzQyxjQTJCdEMsQ0FBYyxRQUFkLEVBM0JzQztDQUF2Qzs7O0FBK0JBLFNBQVMseUJBQVQsQ0FBbUMsSUFBbkMsRUFBd0M7O0NBQXhDOztBQUlBLFNBQVMsbUJBQVQsR0FBOEI7O0NBQTlCOztBQUlBLFNBQVMsY0FBVCxHQUF5Qjs7QUFFeEIsS0FBRyxPQUFPLFlBQVAsS0FBd0IsU0FBeEIsRUFBa0M7QUFDcEMsU0FBTyxZQUFQLEdBQXNCLEVBQXRCLENBRG9DO0FBRXBDLFNBQU8sWUFBUCxDQUFvQixRQUFwQixHQUErQixFQUEvQixDQUZvQztFQUFyQztDQUZEOzs7QUM1Q0EsU0FBUyxXQUFULEdBQXVCO0FBQ3RCLFVBQVMsd0JBQVQsQ0FBa0MsSUFBbEMsRUFBdUM7OztBQUd0QyxVQUFRLEdBQVIsQ0FBWSw4QkFBWixFQUhzQztBQUl0Qyw4QkFBNEIsSUFBNUIsRUFKc0M7QUFLdEMsVUFBUSxHQUFSLENBQVksb0JBQVosRUFMc0M7RUFBdkM7OztBQURzQixLQVdsQixNQUFNLHVFQUF1RSxNQUF2RSxDQUE4RSxnQkFBZ0IsSUFBaEIsQ0FBOUUsQ0FBTixDQVhrQjtBQVl0QixTQUFRLEdBQVIsQ0FBWSxHQUFaLEVBWnNCO0FBYXRCLEdBQUUsSUFBRixDQUFPLEdBQVAsRUFBWSxJQUFaLENBQWlCLFVBQVMsSUFBVCxFQUFlOzs7O0FBSS9CLFVBQVEsR0FBUixDQUFZLElBQVosRUFKK0I7QUFLL0IsMkJBQXlCLElBQXpCLEVBTCtCO0VBQWYsQ0FBakIsQ0Fic0I7Q0FBdkIiLCJmaWxlIjoiYXBwLmpzIiwic291cmNlc0NvbnRlbnQiOlsiXG5cblxuXG5mdW5jdGlvbiBydW5Vc2VybmFtZUNsaWNrKCl7XG5cdC8vVE9ETyB0aGUgdXNlciBoYXMgbm93IGNsaWNrZWQgY2hlY2sgc28gd2UgbmVlZCB0byBtYWtlIHN1cmUgaXRzIG5vdCBlbXB0eSwgZWxzZSBnaXZlIGFuIGVycm9yXG5cdGlmICghZm9ybUlzRW1wdHkoKSkge1xuXHRcdHBvcHVsYXRlVXNlYWJsZVVzZXJOYW1lTGlzdEZyb21TZXJ2aWNlKCk7XG5cdFx0dGVsbFZpZXdSZXF1ZXN0SXNMb2FkaW5nKCk7XG5cdH0gZWxzZSB7XG5cdFx0Y29uc29sZS5sb2coZ2V0Rm9ybVZhbHVlKCkpO1xuXHRcdHRlbGxWaWV3SW5wdXRJc0VtcHR5KClcblx0fVxuXHRcbn1cblxuXG5cbmZ1bmN0aW9uIHJ1bk9ic2VydmVycygpe1xuXHQvL1RPRE8gYWN0dWFsbHkgZmxlc2ggdGhlc2Ugb3V0IHRvIFwiZ3Vlc3NcIiBwb3NzaWJsZSB1c2VybmFtZXMgdG8gc2VuZCBvdmVyIGluIGFkZGl0aW9uIHRvIHdoYXQgdGhleSBjaGVjayB0aGF0IEZJUlNUIGNsaWNrXG5cdHJ1bldvcmRPYnNlcnZlcigpO1xuXHRydW5FbXB0eU9ic2VydmVyKCk7XG59XG5cbmZ1bmN0aW9uIHNldHVwQXBwKCl7XG5cblx0Ly8gVGhlIFVzZXIgc2VhcmNoIEFQSSBhY2NlcHRzIGEgY29tbWEtc2VwYXJhdGVkIGxpc3Qgb2YgdXNlcm5hbWVzLCBhbmQgcmV0dXJuc1xuXHQvLyB1c2VyIGRhdGEgZm9yIGFueSBtYXRjaGluZyByZWNvcmRzXG5cdCQuYWpheChcImh0dHA6Ly9jaGVnZy10dXRvcnMuYXBwc3BvdC5jb20vY29kaW5nLWNoYWxsZW5nZS9hcGkvdXNlci8/dXNlcm5hbWU9SGlsbGFyeTIwMTZcIikuZG9uZShmdW5jdGlvbihkYXRhKSB7XG5cdFx0Ly8gVGhpcyBsb2dzIEhpbGxhcnkyMDE2J3MgdXNlciBkYXRhLCBzaW5jZSB0aGUgdXNlcm5hbWUgaXMgcmVnaXN0ZXJlZFxuXHRcdC8vY29uc29sZS5sb2coSlNPTi5zdHJpbmdpZnkoZGF0YSkpO1xuXHRcdC8vcmF3IHBsZWFzZSB0aGFua3MhISFcblx0XHRjb25zb2xlLmxvZyhkYXRhKTtcblx0ICB9KTtcblx0JC5hamF4KFwiaHR0cDovL2NoZWdnLXR1dG9ycy5hcHBzcG90LmNvbS9jb2RpbmctY2hhbGxlbmdlL2FwaS91c2VyLz91c2VybmFtZT1UcnVtcDRQcmVzLEZlZWxUaGVCZXJuMVwiKS5kb25lKGZ1bmN0aW9uKGRhdGEpIHtcblx0XHQvLyBUaGlzIGxvZ3MgVHJ1bXA0UHJlcydzIHVzZXIgZGF0YSwgc2luY2UgdGhlIHVzZXJuYW1lIGlzIHJlZ2lzdGVyZWQsIGJ1dFxuXHRcdC8vIG5vIHVzZXIgZGF0YSBmb3IgRmVlbFRoZUJlcm4xLCBzaW5jZSB0aGF0IHVzZXJuYW1lIGlzIG5vdCBjdXJyZW50bHkgcmVnaXN0ZXJlZFxuXHRcdC8vY29uc29sZS5sb2coSlNPTi5zdHJpbmdpZnkoZGF0YSk7XG5cdFx0Ly9yYXcgcGxlYXNlIHRoYW5rcyEhIVxuXHRcdGNvbnNvbGUubG9nKGRhdGEpO1xuXHQgIH0pO1xuXHQkKFwiI2NoZy1iYWxsb29uLWlucHV0XCIpLmNoYW5nZShmdW5jdGlvbigpIHtcblx0XHQvLyBUaGlzIGlzIHdoZXJlIHlvdSBjb21lIGluISFcblx0XHQvL2kgY2FtZSBpbiBsaWtlIGEgd3JlY2tpbmcgYmFsbFxuXHRcdGNvbnNvbGUubG9nKCdyYW4gb2JzZXJ2ZXJzJyk7XG5cdFx0cnVuT2JzZXJ2ZXJzKCk7XG5cdH0pO1xuXHQkKFwiI2NoZy1iYWxsb29uLXN1Ym1pdFwiKS5jbGljayhmdW5jdGlvbigpIHtcblx0XHQvLyBUaGlzIGlzIHdoZXJlIHlvdSBjb21lIGluISFcblx0XHQvL2kgY2FtZSBpbiBsaWtlIGEgd3JlY2tpbmcgYmFsbFxuXHRcdGNvbnNvbGUubG9nKCdjbGljayByYW4nKTtcblx0XHRydW5Vc2VybmFtZUNsaWNrKCk7XG5cdH0pO1xufSIsIlxuXG5cblxuXG5cbmZ1bmN0aW9uIHJ1bkVtcHR5T2JzZXJ2ZXIoKSB7XG5cdC8vIFRPRE8gdGhlIGZvcm0gaXMgbm93IGVtcHR5IHNvIHdlIHNob3VsZCBjbGVhciB0aGUgbGlzdCBvZiB1c2VhYmxlIHVzZXJuYW1lcyAoYWRkIHRoZW0gdG8gYmFkZCBsaXN0Pylcblx0Ly8gVE9ETyB3ZSBzaG91bGQgYWxzbyBjbGVhciBvdXQgdGhlIHN1Z2dlc3RlZCBsaXN0XG5cdGlmIChmb3JtSXNFbXB0eSgpKSB7XG5cdFx0Y29uc29sZS5sb2coJ2VtcHR5IG9ic2VydmVyIHdvdWxkdmUganVzdCBub3cgcmFuJyk7XG5cdH1cbn0iLCJcblxuXG5cblxuZnVuY3Rpb24gcnVuV29yZE9ic2VydmVyKCkge1xuXHQvLyBUT0RPIHRoZSBmb3JtIGlzIGJlaW5nIHR5cGVkIGluIHNvIHdlIG5lZWQgdG8gc2V0IHNvbWUgdGhpbmdzIHRvIGNoZWNrIGZvciB0byB0cnkgYW5kIGd1ZXNzL2Fzc3VtZSB3b3Jkc1xuXHQvLyBUT0RPIGNoZWNrIGlmIGEgdXNlciB1c2VkIGNvbW1vbiB3YXlzIHRvIGRlbm90ZSBhIGNoYW5nZSBpbiB0aGUgd29yZC4gXG5cdC8vVE9ETyBhZnRlciBhYm92ZSB0aGVuIGFkZCB0aGUgd29yZCB0aGF0IGp1c3QgZW5kZWQgdG8gdGhlIGxpc3QgaWYgbm90IGFscmVhZHkgdGhlcmVcblx0aWYgKCFmb3JtSXNFbXB0eSgpKSB7XG5cdFx0Y29uc29sZS5sb2coJ3dvcmQgb2JzZXJ2ZXIgd291bGR2ZSBqdXN0IG5vdyByYW4nKTtcblx0fVxufSIsIlxuXG5cblxuXG5cblxuXG5mdW5jdGlvbiBmb3JtSXNFbXB0eSgpIHtcblx0Ly8gYm9keS4uLlxuXHRpZiAoZ2V0Rm9ybVZhbHVlKCkgPT0gXCJcIikge1xuXHRcdHJldHVybiB0cnVlO1xuXHR9XG5cdHJldHVybiBmYWxzZTtcbn1cblxuXG5mdW5jdGlvbiBnZXRGb3JtVmFsdWUoKSB7XG5cdHJldHVybiAkKFwiI2NoZy1iYWxsb29uLWlucHV0XCIpLnZhbCgpO1xufSIsIlxuXG5cbmZ1bmN0aW9uIHRlbGxWaWV3UmVxdWVzdElzTG9hZGluZygpIHtcblx0Ly9UT0RPIHdlIGFkZCBpbiBhIFwid2VyZSBsb2FkaW5nXCIgbWVzc2FnZSBmb3IgdGhlIHVzZXJcbn1cblxuZnVuY3Rpb24gdGVsbFZpZXdSZXF1ZXN0SXNEb25lKG5hbWVzKSB7XG5cdHZhciBuZXdIVE1MID0gXCJcIlxuXHRmdW5jdGlvbiBhZGRUb0l0ZXJhdGVBcnJheShuYW1lKSB7XG5cdFx0bmV3SFRNTCA9IG5ld0hUTUwuY29uY2F0KFwiPGkgY2xhc3M9J2dyZWVuIGNoZWNrbWFyayBib3ggaWNvbic+PC9pPlwiLmNvbmNhdCggbmFtZSwgXCI8L2JyPlwiKSk7XG5cdH1cblx0bmFtZXMuZm9yRWFjaChhZGRUb0l0ZXJhdGVBcnJheSk7XG5cdCQoXCIjdXNlcm5hbWUtc3VnZ2VzdGlvbi12aWV3XCIpLmh0bWwobmV3SFRNTCk7XG59XG5cbmZ1bmN0aW9uIHRlbGxWaWV3SW5wdXRJc0VtcHR5KCkge1xuXHQvLyBib2R5Li4uXG59XG5cblxuXG5mdW5jdGlvbiB0ZWxsVmlld05hbWVJc0F2YWlsYWJsZSgpe1xuXHR2YXIgbmV3SFRNTCA9IFwiPGkgY2xhc3M9J2dyZWVuIGNoZWNrbWFyayBib3ggaWNvbic+PC9pPlwiLmNvbmNhdChnZXRGb3JtVmFsdWUoKSApO1xuXHRuZXdIVE1MID0gbmV3SFRNTC5jb25jYXQoXCIsIGlzIEF2YWlsYWJsZSEgSGl0IG5leHQgdG8gcHJvY2VkIChvciBub3JtYWxseSB3aGVyZSB0aGUgcHJvZ3JhbW1lciB3b3VsZCBqdXN0IGF1dG8gbW92ZSBvbiB0byB0aGUgbmV4dCBwYXJ0KVwiKTtcblx0JChcIiN1c2VybmFtZS1hdmFpbGFiaWxpdHlcIikuaHRtbChuZXdIVE1MKTtcbn1cblxuZnVuY3Rpb24gdGVsbFZpZXdOYW1lSXNVbkF2YWlsYWJsZSgpe1xuXHR2YXIgbmV3SFRNTCA9IFwiPGkgY2xhc3M9J3JlZCBjaGVja21hcmsgYm94IGljb24nPjwvaT5cIi5jb25jYXQoZ2V0Rm9ybVZhbHVlKCkpO1xuXHRuZXdIVE1MID0gbmV3SFRNTC5jb25jYXQoXCIsIGlzIFVuLWF2YWlsYWJsZSEgUGxlYXNlIHRyeSBhIHN1Z2dlc3Rpb24gZnJvbSBiZWxvdyBvciB0cnkgYSBuZXcgdXNlcm5hbWUhXCIpO1xuXHQkKFwiI3VzZXJuYW1lLWF2YWlsYWJpbGl0eVwiKS5odG1sKG5ld0hUTUwpO1xufSIsIlxuXG5cbmZ1bmN0aW9uIHNldHVwVXNlck5hbWVMaXN0KCl7XG5cdC8vc2luY2UgSSBkb250IGhhdmUgYW55dGhpbmcgdG8gYWN0IGFzIFwic2NvcGVcIiB3ZSB3aWxsIHByZXRlbmQgbGlrZSBpdHMgdGhlIHdob2xlIHdpbmRvdyAoYXBwKVxuXHRpZih3aW5kb3cuVVNFUk5BTUVMSVNUID09PSB1bmRlZmluZWQpe1xuXHRcdHdpbmRvdy5VU0VSTkFNRUxJU1QgPSB7fTtcblx0XHR3aW5kb3cuVVNFUk5BTUVMSVNULnVzZXJuYW1lTGlzdCA9IFtdO1xuXHRcdHdpbmRvdy5VU0VSTkFNRUxJU1QuZ29vZFVzZXJOYW1lcyA9IFtdO1xuXHRcdHdpbmRvdy5VU0VSTkFNRUxJU1QuYmFkVXNlck5hbWVzID0gW107XG5cdH1cbn1cblxuZnVuY3Rpb24gdXNlck5hbWVMZW5ndGgoKSB7XG5cdHJldHVybiB3aW5kb3cuVVNFUk5BTUVMSVNULnVzZXJuYW1lTGlzdC5sZW5ndGg7XG59XG5cbi8vdGhpcyBqdXN0IHJldHVybnMgYSBsaXN0IG9mIHVzZWFibGUgdXNlcm5hbWUgb2JqZWN0cywgb3IgYSBzdHJpbmcgZm9yIHVzZSB3aXRoaW4gYSByZXF1ZXN0LiBkZXBlbmRpbmcgb24gdGhlIGZvcm1lciB3aWxsIGRlcGVuZCBvbiB3aGF0IGl0IHJldHVybnMgdXBvbiBmYWlsLCBub3Qgc3VyZSBqdXN0IHlldCBsb3RzIHRvIGRvXG5mdW5jdGlvbiBnZXRVc2VyTmFtZUxpc3QoZm9yUmVxdWVzdCA9IGZhbHNlKSB7XG5cblxuXHQvL0kgd2FudGVkIHRvIG1ha2Ugc3VyZSB0aGF0IG9ubHkgdGhpcyBmdW5jdGlvbiBjYW4gZ2V0IGNhbGxlZCwgc28gdGhhdCBpdCB3aWxsIHJldHVybiB0aGUgcHJvcGVyIHN0dWZmLCBlbmNhcHN1bGF0aW9uIHRoaW5ncy5cblx0Ly90aGlzIHJldHVybnMgdGhlIGxpc3Qgb2YgR09PRCB1c2VybmFtZXMgYXMgYW4gYXJyYXlcblx0ZnVuY3Rpb24gZ2V0VXNlYWJsZVVzZXJOYW1lTGlzdEZvckFuSXRlcmF0aW9uKCkge1xuXHR9XG5cblx0Ly90aGlzIHJldHVybnMgdGhlIGxpc3Qgb2YgdXNlcm5hbWVzIGFzIGEgc3RyaW5nXG5cdGZ1bmN0aW9uIGdldFVzZWFibGVVc2VyTmFtZUxpc3RGb3JBUmVxdWVzdCgpIHtcblx0XHQvL3RoaXMgaXMgbmVlZGVkIHRvIGFjdHVhbGx5IHJldHVybiBzb21ldGhpbmdcblx0XHR2YXIgcmV0dXJuU3RyaW5nID0gXCJcIjtcblxuXHRcdC8vbGV0cyBtYWtlIHN1cmUgdGhhdCB0aGlzIHNjb3BlIGhhcyB0aGUgYWJpbGl0eSB0byBmb3JlYWNoIG92ZXIgdGhlIGFycmF5IHdlIGFyZSBhYm91dCB0byBjcmVhdGVcblx0XHQvL3dpdGhvdXQgaGF2aW5nIHRvIGNyZWF0ZSB0aGUgZnVuY3Rpb24gaW4gbGluZVxuXHRcdGZ1bmN0aW9uIGFkZFVzZXJOYW1lKGl0ZW0pe1xuXHRcdFx0Y29uc29sZS5sb2coaXRlbSk7XG5cdFx0XHRyZXR1cm5TdHJpbmcgPSByZXR1cm5TdHJpbmcuY29uY2F0KGl0ZW0pO1xuXHRcdFx0cmV0dXJuU3RyaW5nID0gcmV0dXJuU3RyaW5nLmNvbmNhdChcIixcIik7XG5cdFx0fVxuXHRcdHdpbmRvdy5VU0VSTkFNRUxJU1QudXNlcm5hbWVMaXN0LmZvckVhY2goYWRkVXNlck5hbWUpXG5cdFx0cmV0dXJuU3RyaW5nID0gcmV0dXJuU3RyaW5nLnN1YnN0cmluZygwLCByZXR1cm5TdHJpbmcubGVuZ3RoLTEpXG5cdFx0cmV0dXJuIHJldHVyblN0cmluZztcblx0fVxuXG5cdGlmKGZvclJlcXVlc3Qpe1xuXHRcdHJldHVybiBnZXRVc2VhYmxlVXNlck5hbWVMaXN0Rm9yQVJlcXVlc3QoKTtcblx0fWVsc2V7XG5cdFx0cmV0dXJuIGdldFVzZWFibGVVc2VyTmFtZUxpc3RGb3JBUmVxdWVzdCgpO1xuXHR9XG59XG5cblxuXG5cblxuLy90aGlzIGFjdHVhbGx5IHNldHMgdXAsIHRoZW4gcnVucyB0aGUgYWpheCByZXF1ZXN0XG5mdW5jdGlvbiBwb3B1bGF0ZVVzZWFibGVVc2VyTmFtZUxpc3RGcm9tU2VydmljZSgpIHtcblx0Ly8gVE9ETyBjaGVjayB0aGUgYmVsb3cgcnVucyBjb3JyZWN0bHlcblx0c2V0dXBVc2VyTmFtZUxpc3QoKTtcblx0aWYgKHVzZXJOYW1lTGVuZ3RoKCkgPCAxKSB7XG5cdFx0Y29uc29sZS5sb2coJ25vIHVzZWFibGUgdXNlcm5hbWVzIHByZWdlbmVyYXRlZCEnKTtcblx0XHRub1VzZWFibGVVc2VybmFtZXNBZGROdW1iZXJzKCk7XG5cdH1cblx0Ly8gVE9ETyB1c2UgdGhlIGpzb24gc2VydmljZSB0byBzZW5kIGEgcmVxdWVzdCB1c2luZyB0aGUgdXNlcm5hbWVMaXN0IGZyb20gd2luZG93IHNjb3BlXG5cdHNlbmRSZXF1ZXN0KCk7XG59XG5cblxuLy90aGlzIGlzIHRoZSBmdWNudGlvbiB0aGF0IGFqYXggY2FsbHMgd2hlbiBpdCBzdWNjZXNzZnVsbGx5IHJlY2lldmVzIGEgcmVzcG9uc2VcbmZ1bmN0aW9uIHBvcHVsYXRlVXNlYWJsZVVzZXJOYW1lTGlzdChkYXRhKSB7XG5cdHZhciBpbnB1dFVzZXJOYW1lSXNBdmFpbGFibGUgPSB0cnVlO1xuXHRmdW5jdGlvbiBtYXBEYXRhVG9Vc2VyTmFtZUFycmF5KHZhbHVlLCBpbmRleCl7XG5cdFx0cmV0dXJuIHZhbHVlLnVzZXJuYW1lO1xuXHR9XG5cdGZ1bmN0aW9uIHNldHVwQmFkVXNlck5hbWUoaXRlbSl7XG5cdFx0aWYgKGdldEZvcm1WYWx1ZSgpID09IGl0ZW0pIHtcblx0XHRcdGlucHV0VXNlck5hbWVJc0F2YWlsYWJsZSA9IGZhbHNlO1xuXHRcdH1cblx0XHR3aW5kb3cuVVNFUk5BTUVMSVNULmJhZFVzZXJOYW1lcy5wdXNoKFN0cmluZyhpdGVtKSk7XG5cdH1cblxuXHRmdW5jdGlvbiBzZXR1cEdvb2RVc2VyTmFtZShpdGVtKXtcblx0XHRpZiAod2luZG93LlVTRVJOQU1FTElTVC5iYWRVc2VyTmFtZXMuaW5kZXhPZihTdHJpbmcoaXRlbSkpICA9PSAtMSkge1xuXHRcdFx0d2luZG93LlVTRVJOQU1FTElTVC5nb29kVXNlck5hbWVzLnB1c2goU3RyaW5nKGl0ZW0pKTtcblx0XHR9XG5cdH1cblx0Ly9kb250IGZvcmdldCB5b3UgY2FudCBpdGVyYXRlIGJsaW5kbHkgb3ZlciBhbiBvYmplY3QgbGlrZSB0aGlzIGlzIG1vbmdvIGFkYW0hISEhXG5cdGRhdGEgPSAkLm1hcChkYXRhLCBtYXBEYXRhVG9Vc2VyTmFtZUFycmF5KTtcblx0Ly8gVE9ETyBjaGVjayB0aGUgYmVsb3cgcnVucyBjb3JyZWN0bHlcblx0c2V0dXBVc2VyTmFtZUxpc3QoKTtcblx0ZGF0YS5mb3JFYWNoKHNldHVwQmFkVXNlck5hbWUpO1xuXHR3aW5kb3cuVVNFUk5BTUVMSVNULnVzZXJuYW1lTGlzdC5mb3JFYWNoKHNldHVwR29vZFVzZXJOYW1lKTtcblx0d2luZG93LlVTRVJOQU1FTElTVC51c2VybmFtZUxpc3QgPSBbXVxuXHQvLyBUT0RPIGZyb20gcmVzcG9uc2UgcHV0IGxpc3Qgb2YgZ29vZCB1c2VybmFtZXMgaW4gcGxhY2Vcblx0aWYgKGlucHV0VXNlck5hbWVJc0F2YWlsYWJsZSkge1xuXHRcdHRlbGxWaWV3TmFtZUlzQXZhaWxhYmxlKCk7XG5cdH0gZWxzZSB7XG5cdFx0dGVsbFZpZXdOYW1lSXNVbkF2YWlsYWJsZSgpO1xuXHR9XG5cdHRlbGxWaWV3UmVxdWVzdElzRG9uZSh3aW5kb3cuVVNFUk5BTUVMSVNULmdvb2RVc2VyTmFtZXMpO1xufVxuXG4vL3RoaXMgaXMgdXNlZCBieSB0aGUgZm9ybSBvYnNlcnZlcnMgdG8gYWRkIGluIHBvc3NpYmxlIG5hbWVzIGFzIHRoZXkgZmluZCB0aGVtXG5mdW5jdGlvbiBhZGROYW1lVG9MaXN0KG5hbWUpe1xuXHQvLyBUT0RPIGNoZWNrIHRoZSBiZWxvdyBydW5zIGNvcnJlY3RseVxuXHRzZXR1cFVzZXJOYW1lTGlzdCgpO1xuXHQvL2FnYWluIGNhc2luZyBhcyBzdHJpbmcgY3V6IGl2ZSBwdXQgbm8gdGltZSBpbnRvIGVycm9yIGhhbmRsaW5lXG5cdHdpbmRvdy5VU0VSTkFNRUxJU1QudXNlcm5hbWVMaXN0LnB1c2goU3RyaW5nKG5hbWUpKTtcbn1cblxuLy90aGlzIGlzIHVzZWQgYnkgdGhlIGFqYXggcmVzcG9uc2UgZnVuY3Rpb24gdG8gYWRkIGluIG5hbWVzIHRoYXQgd29udCB3b3JrXG5mdW5jdGlvbiBhZGROYW1lVG9CYWRMaXN0KG5hbWUpe1xuXHQvLyBUT0RPIGFkZCBpbiBuYW1lIHRvIHRoZSBsaXN0IG9mIGJhZCB1c2VyIG5hbWVzIGluIHdpbmRvdyBzY29wZVxufVxuXG5cbi8vdGhpcyBpcyB1c2VkIGJ5IHRoZSBhamF4IHJlc3BvbnNlIGZ1bmN0aW9uIHRvIGFkZCBpbiBuYW1lcyB0aGF0IHdpbGwgd29ya1xuZnVuY3Rpb24gYWRkTmFtZVRvR29vZExpc3QobmFtZSl7XG5cdC8vIFRPRE8gYWRkIGluIG5hbWUgdG8gdGhlIGxpc3Qgb2YgZ29vZCB1c2VyIG5hbWVzIGluIHdpbmRvdyBzY29wZVxufSIsIi8vVE9ETyBpbXBsZW1lbnQgdGhpcyBvdXQgdG8gYWN0dWFsbHkgY2hlY2sgZm9yIHdvcmRzLCBpbnN0ZWFkIG9mIGp1c3QgYmVpbmcgYWxsIFwiaGV5IGxvb2sgaSBjYW4gYWRkIDIgbnVtYmVycyBhdCB0aGUgZW5kXCJcblxuXG5cbmZ1bmN0aW9uIGZpbmFsV29yZENoZWNrKCkge1xuXHQvLyBUT0RPIGJlZm9yZSB3ZSBzZW5kIG9mZiB0aGUgcmVxdWVzdCwgbWFrZSBzdXJlIHdlIGhhdmUgZW5vdWdoIHVzZXIgbmFtZXMgYmVpbmcgc2VudCBvZiBpbiB0aGUgcmVxdWVzdFxuXHQvLyBUT0RPIG1ha2Ugc3VyZSB0aGUgYmVsb3cgZ2V0cyBjYWxsZWQgYXQgdGhlIHJpZ2h0IHRpbWUsIGFuZCB3b3Jrc1xufVxuXG5mdW5jdGlvbiBub1VzZWFibGVVc2VybmFtZXNBZGROdW1iZXJzKCl7XG5cdC8vIFRPRE8gd2UgaGF2ZW50IGRvbmUgc28gd2VsbCBhbmQgaGF2ZSBubyB3b3JkcyB0byB1c2UgdG8gZ2VuZXJhdGUgc29tZSBnb29kIHdvcmRzLCBqdXN0IGFkZCBzb21lIG51bWJlcnMgdG8gd2hhdHMgaW4gdGhlIGZvcm0gOihcblxuXG5cdC8vbGV0cyBtYWtlIHN1cmUgdGhhdCB0aGlzIHNjb3BlIGhhcyB0aGUgYWJpbGl0eSB0byBmb3JlYWNoIG92ZXIgdGhlIGFycmF5IHdlIGFyZSBhYm91dCB0byBjcmVhdGVcblx0Ly93aXRob3V0IGhhdmluZyB0byBjcmVhdGUgdGhlIGZ1bmN0aW9uIGluIGxpbmVcblx0ZnVuY3Rpb24gYWRkUmFuZG9tVXNlck5hbWUoaXRlbSl7XG5cdFx0YWRkTmFtZVRvTGlzdChmb3JtV29yZC5jb25jYXQoaXRlbSkpO1xuXHR9XG5cblx0Y29uc29sZS5sb2coJ08gTm8hIG9ic2VydmVycyBmb3VuZCBubyB3b3JkcywgYWRkaW5nIG51bWJlcnMgc28gd2UgaGF2ZSBzb21lIG5vdycpO1xuXHQvL2ZpcnN0IHdlIG5lZWQgc29tZSBudW1iZXJzXG5cdC8vbGV0cyBtYWtlIHN1cmUgdGhleSBkb250IGhhdmUgYSB3YXkgb2YgYmVpbmcgdGhlIHNhbWUhISEhXG5cdHZhciByYW5kb21OdW1iZXIgPSBNYXRoLmZsb29yKCBNYXRoLnJhbmRvbSgpICogMTAwMCApO1xuXHR2YXIgcmFuZG9tTW9kaWZlciA9IE1hdGguZmxvb3IoIE1hdGgucmFuZG9tKCkgKiAxMDAgKTtcblx0dmFyIHJhbmRvbURpdmlkZXIgPSBNYXRoLmZsb29yKCBNYXRoLnJhbmRvbSgpICogMTAgKTtcblx0dmFyIHJhbmRvbU51bWJlcnMgPSBbXG5cdFx0U3RyaW5nKHJhbmRvbU51bWJlciksXG5cdFx0U3RyaW5nKHJhbmRvbU51bWJlciArIHJhbmRvbU1vZGlmZXIpLFxuXHRcdFN0cmluZyhyYW5kb21OdW1iZXIgLSByYW5kb21Nb2RpZmVyKSxcblx0XHRTdHJpbmcoTWF0aC5mbG9vcigocmFuZG9tTnVtYmVyICsgcmFuZG9tTW9kaWZlcikgLyByYW5kb21EaXZpZGVyICkpLFxuXHRcdFN0cmluZyhNYXRoLmZsb29yKChyYW5kb21OdW1iZXIgLSByYW5kb21Nb2RpZmVyKSAgLyByYW5kb21EaXZpZGVyICkpLFxuXHRdXG5cdC8vdGhlbiB3ZSBuZWVkIHRvIGdldCB0aGUgdXNlcm5hbWUgaXRzZWxmLCBnb25uYSBjYXN0IGFzIHN0cmluZyBjdXouLi4gaSBoYXZlIG5vIGVycm9yIGhhbmRsaW5nIGxpa2UgYW55d2hlcmUgaW4gaGVyZSBhbmQgaW0gc2NhcmVkXG5cdHZhciBmb3JtV29yZCA9IFN0cmluZyhnZXRGb3JtVmFsdWUoKSk7XG5cdHJhbmRvbU51bWJlcnMuZm9yRWFjaChhZGRSYW5kb21Vc2VyTmFtZSk7XG5cdC8vY2FudCBmb3JnZXQgdG8gYWRkIHRoZSBvbmUgdGhhdCB0aGUgdXNlciBhbHJlYWR5IHN1Z2dlc3RlZCBzaW5jZSBldmVyeXRoaW5nIGlzIGVtcHR5ISEhXG5cdGFkZE5hbWVUb0xpc3QoZm9ybVdvcmQpO1xufVxuXG4vL29uZSBvZiB0aGUgb2JzZXJ2ZXJzIG1heSBoYXZlIGZvdW5kIGEgbmV3IHdvcmQgdG8gdXNlLCBjaGVjayBmb3IgaXQgdGhlbiBhZGQgaXQgaW5cbmZ1bmN0aW9uIGFkZFdvcmRUb1VzZWFibGVXb3Jkc0xpc3Qod29yZCl7XG5cdC8vIFRPRE8gbWFrZSB0aGUgYWJvdmUgY29tbWVudCBjb21lIHRydWVcbn1cblxuZnVuY3Rpb24gZ2V0VXNlYWJsZVdvcmRzTGlzdCgpe1xuXHQvLyBUT0RPIFxufVxuXG5mdW5jdGlvbiBzZXR1cFdvcmRzTGlzdCgpe1xuXHQvL3NpbmNlIEkgZG9udCBoYXZlIGFueXRoaW5nIHRvIGFjdCBhcyBcInNjb3BlXCIgd2Ugd2lsbCBwcmV0ZW5kIGxpa2UgaXRzIHRoZSB3aG9sZSB3aW5kb3cgKGFwcClcblx0aWYod2luZG93LldPUkRPQlNFUlZFUiA9PT0gdW5kZWZpbmVkKXtcblx0XHR3aW5kb3cuV09SRE9CU0VSVkVSID0ge307XG5cdFx0d2luZG93LldPUkRPQlNFUlZFUi53b3JkbGlzdCA9IHt9O1xuXHR9XG59IiwiXG5cblxuXG5mdW5jdGlvbiBzZW5kUmVxdWVzdCgpIHtcblx0ZnVuY3Rpb24gcHJvZWNjZXNzUmVxdWVzdFJlc3BvbnNlKGRhdGEpe1xuXHRcdC8vIFRoaXMgbG9ncyBUcnVtcDRQcmVzJ3MgdXNlciBkYXRhLCBzaW5jZSB0aGUgdXNlcm5hbWUgaXMgcmVnaXN0ZXJlZCwgYnV0XG5cdFx0Ly8gbm8gdXNlciBkYXRhIGZvciBGZWVsVGhlQmVybjEsIHNpbmNlIHRoYXQgdXNlcm5hbWUgaXMgbm90IGN1cnJlbnRseSByZWdpc3RlcmVkXG5cdFx0Y29uc29sZS5sb2coXCJyZXF1ZXN0IGRvbmUsIGxvZ2ljIHN0YXJ0aW5nXCIpO1xuXHRcdHBvcHVsYXRlVXNlYWJsZVVzZXJOYW1lTGlzdChkYXRhKTtcblx0XHRjb25zb2xlLmxvZyhcInJlcXVlc3QgbG9naWMgZG9uZVwiKTtcblx0fVxuXG5cblx0Ly8gVE9ETyB1c2UgdGhlIGJlbG93IGNvcGllZCBjb2RlIHRvIGJyaW5nIGFsbCB0aGUgY29tbWVudHMgYmVsb3cgaXQgdG8gbGlmZVxuXHR2YXIgdXJsID0gXCJodHRwOi8vY2hlZ2ctdHV0b3JzLmFwcHNwb3QuY29tL2NvZGluZy1jaGFsbGVuZ2UvYXBpL3VzZXIvP3VzZXJuYW1lPVwiLmNvbmNhdChnZXRVc2VyTmFtZUxpc3QodHJ1ZSkpO1xuXHRjb25zb2xlLmxvZyh1cmwpO1xuXHQkLmFqYXgodXJsKS5kb25lKGZ1bmN0aW9uKGRhdGEpIHtcblx0XHQvLyBUaGlzIGxvZ3MgSGlsbGFyeTIwMTYncyB1c2VyIGRhdGEsIHNpbmNlIHRoZSB1c2VybmFtZSBpcyByZWdpc3RlcmVkXG5cdFx0Ly9jb25zb2xlLmxvZyhKU09OLnN0cmluZ2lmeShkYXRhKSk7XG5cdFx0Ly9yYXcgcGxlYXNlIHRoYW5rcyEhIVxuXHRcdGNvbnNvbGUubG9nKGRhdGEpO1xuXHRcdHByb2VjY2Vzc1JlcXVlc3RSZXNwb25zZShkYXRhKTtcblx0ICB9KTtcbn0iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
